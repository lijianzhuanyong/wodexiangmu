"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,e,s){return e&&_defineProperties(t.prototype,e),s&&_defineProperties(t,s),t}var textValue=document.querySelector(".search_text"),search_boxDom=document.querySelector(".search_box");function getList(){$.ajax({url:"../lib/nav_top.json",dataType:"json",success:function(i){console.log(i);var e="";i.forEach(function(t){e+="<li><a>".concat(t.name,"</a></li>")}),$("#header2 > .top2 > ul").html(e).on({mouseenter:function(){return $("#nav").stop().slideDown()},mouseleave:function(){return $("#nav").stop().slideUp()}}).children("li").on("mouseover",function(){var t=$(this).index(),e=i[t].list,s="";e.forEach(function(t){s+='\n                        <li>\n                            <img src="'.concat(t.list_url,'" alt="">\n                            <p class="title">').concat(t.list_name,'</p>\n                            <span class="price">').concat(t.list_price,"</span>\n                        </li>\n                    ")}),$("#nav > ul").html(s)}),$("#nav").on({mouseover:function(){$(this).finish().show()},mouseout:function(){$(this).finish().slideUp()}})}})}search_boxDom.onmouseenter=function(){textValue.style.width="440px"},search_boxDom.onmouseleave=function(){""==textValue.value&&document.activeElement!=textValue&&(textValue.style.width="0px")},textValue.onblur=function(){""==textValue.value&&(textValue.style.width="0px")},getList();var Enlarge=function(){function e(t){_classCallCheck(this,e),this.ele=document.querySelector(t),this.init()}return _createClass(e,[{key:"init",value:function(){var t=this;this.show=this.ele.querySelector(".show"),this.mask=this.ele.querySelector(".mask"),this.enlarge=this.ele.querySelector(".enlarge"),this.show.onmouseover=function(){t.mask.style.display=t.enlarge.style.display="block",t.setStyle(),t.move()},this.show.onmouseout=function(){t.mask.style.display=t.enlarge.style.display="none"},this.p=this.ele.querySelector(".list").children;for(var e=this,s=0;s<this.p.length;s++)this.p[s].onclick=function(){e.change(this)}}},{key:"setStyle",value:function(){this.maskWidth=this.mask.offsetWidth,this.maskHeight=this.mask.offsetHeight,this.bgx=parseInt(getStyle(this.enlarge,"background-size").split(" ")[0]),this.bgy=parseInt(getStyle(this.enlarge,"background-size").split(" ")[1]),this.showWidth=this.show.clientWidth,this.showHeight=this.show.clientHeight;var t=this.maskWidth*this.bgx/this.showWidth,e=this.maskHeight*this.bgy/this.showHeight;this.enlarge.style.width=t+"px",this.enlarge.style.height=e+"px"}},{key:"move",value:function(){var n=this;this.show.onmousemove=function(t){var e=t.clientX-n.ele.offsetLeft-n.maskWidth/2,s=t.clientY-n.ele.offsetTop-n.maskHeight/2;e<=0&&(e=0),s<=0&&(s=0),e>=n.showWidth-n.maskWidth&&(e=n.showWidth-n.maskWidth),s>=n.showHeight-n.maskHeight&&(s=n.showHeight-n.maskHeight),n.mask.style.left=e+"px",n.mask.style.top=s+"px";var i=n.bgx*e/n.showWidth,o=n.bgy*s/n.showHeight;n.enlarge.style.backgroundPosition="-".concat(i,"px -").concat(o,"px")}}},{key:"change",value:function(t){for(var e=0;e<this.p.length;e++)this.p[e].classList.remove("active");t.classList.add("active");var s=t.getAttribute("bigImg"),i=t.getAttribute("img");this.img=this.show.querySelector("img"),this.img.setAttribute("src",i),this.enlarge.style.backgroundImage="url(".concat(s,")")}}]),e}();new Enlarge(".box");var goodsInfo=JSON.parse(localStorage.getItem("goods_info"));function bindHtml(){$("p").attr("img",goodsInfo.list_url),$("p").attr("bigImg",goodsInfo.list_url),$(".box > .list > p > img").attr("src",goodsInfo.list_url),$(".box > .show > img").attr("src",goodsInfo.list_url),$(".jia > .ming").text(goodsInfo.list_name),$(".jia > .ke > mark").text("￥"+goodsInfo.list_price),$(".jia > .zong > .ming").text(goodsInfo.list_name),$(".jia > .zong > mark").text("￥"+goodsInfo.list_price)}null===goodsInfo&&alert("你查看的商品详情不存在了"),bindHtml(),$(".jiar").click(function(){var t=JSON.parse(localStorage.getItem("cartList"))||[],e=t.some(function(t){return t.list_id===goodsInfo.list_id});if(console.log(e),e){console.log("数据已经存在");for(var s=null,i=0;i<t.length;i++)if(t[i].list_id===goodsInfo.list_id){s=t[i];break}s.number++,s.xiaoji=s.number*s.list_price}else goodsInfo.number=1,goodsInfo.xiaoji=goodsInfo.list_price,goodsInfo.isSelect=!1,t.push(goodsInfo);localStorage.setItem("cartList",JSON.stringify(t))});